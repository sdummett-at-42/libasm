# **************************************************************************** #
#       COMMANDS                                                               #
# **************************************************************************** #
NASM		=	nasm
AR			=	ar
ARFLAGS		=	rcs
RM			=	rm

# **************************************************************************** #
#       TITLE                                                                  #
# **************************************************************************** #
NAME		=	libasm.a

# **************************************************************************** #
#       FLAGS                                                                  #
# **************************************************************************** #
NASMFLAGS	=	-felf64
INCS		=	-Iincs
RMFLAGS		=	-rf
# CFLAGS		=	-Wall -Wextra -Werror -I$(CURDIR)

# **************************************************************************** #
#       SOURCES                                                                #
# **************************************************************************** #
SRCS		=	srcs/ft_strlen.s \
				srcs/ft_strcpy.s
# srcs/ft_strcpy.s

# **************************************************************************** #
#       RULES                                                                  #
# **************************************************************************** #
OBJS		=	$(SRCS:.s=.o)

%.o			:	%.s
				$(NASM) $(NASMFLAGS) $< -o $@

$(NAME)		:	$(OBJS)
				$(AR) $(ARFLAGS) $(NAME) $(OBJS)

all			:	$(NAME)

tests		:	$(NAME)
				@clang -I. -o test tests/*.c -L. -lasm
				@./test
				@rm test

clean		:
				$(RM) $(RMFLAGS) $(OBJS)

fclean		:	clean
				$(RM) $(RMFLAGS) $(NAME) a.out

re			:	fclean all

# **************************************************************************** #
#       PHONY                                                                  #
# **************************************************************************** #
.PHONY		:	all clean fclean re tests